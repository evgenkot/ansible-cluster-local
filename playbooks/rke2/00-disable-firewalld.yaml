---
- hosts: all
  gather_facts: no
  become: true
  tasks:
    - name: Gather service facts
      ansible.builtin.service_facts:

    - name: Disable and stop firewalld service
      ansible.builtin.systemd:
        name: firewalld
        enabled: false
        state: stopped
      when:
        - "'firewalld.service' in ansible_facts.services"
